{% extends "base.html" %}

{% block content %}

<!-- Hero Section - Split Screen con Gallery Rotante -->
<section id="home" class="hero-creative">
    <div class="hero-split">
        <!-- Left: Rotating Image Gallery -->
        <div class="hero-gallery">
            <div class="gallery-slider">
                <div class="gallery-slide active"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/1.jpg') }}" alt="Outfit 1"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/2.jpg') }}" alt="Outfit 2"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/3.jpg') }}" alt="Outfit 3"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/4.jpg') }}" alt="Outfit 4"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/5.jpg') }}" alt="Outfit 5"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/7.jpg') }}" alt="Outfit 7"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/8.jpg') }}" alt="Outfit 8"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/9.jpg') }}" alt="Outfit 9"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/10.jpg') }}" alt="Outfit 10"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/11.jpg') }}" alt="Outfit 11"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/17.jpg') }}" alt="Outfit 17"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/18.jpg') }}" alt="Outfit 18"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/19.jpg') }}" alt="Outfit 19"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/20.jpg') }}" alt="Outfit 20"></div>
                <div class="gallery-slide"><img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/21.jpg') }}" alt="Outfit 21"></div>
            </div>
            <div class="gallery-overlay"></div>
        </div>

        <!-- Right: Hero Text -->
        <div class="hero-text-area">
            <div class="hero-text-content">
                <span class="hero-label">Noleggio Moda Bambini</span>
                <h1 class="hero-title-new">Vesti i tuoi piccoli con stile</h1>
                <p class="hero-subtitle-new">Occasioni speciali, shooting fotografici, feste indimenticabili. Qualità premium, sostenibilità garantita.</p>
                <div class="hero-buttons-new">
                    <a href="#products" class="btn-new btn-primary-new">
                        <span>Esplora Collezione</span>
                        <i class="fas fa-arrow-right"></i>
                    </a>
                    <a href="#how-it-works" class="btn-new btn-secondary-new">
                        <span>Come Funziona</span>
                    </a>
                </div>

                <!-- Quick Stats -->
                <div class="hero-stats">
                    <div class="stat-item">
                        <i class="fas fa-leaf"></i>
                        <div>
                            <strong>100%</strong>
                            <span>Sostenibile</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-tshirt"></i>
                        <div>
                            <strong>500+</strong>
                            <span>Outfit</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-award"></i>
                        <div>
                            <strong>Premium</strong>
                            <span>Qualità</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Categories Section -->
<section class="categories-section">
    <div class="container">
        

        <div class="categories-grid">
            <!-- Shooting Card -->
            <div class="category-card">
                <div class="category-image-wrapper">
                    <img src="{{ url_for('static', filename='immagini/shooting vecchi/shooting/12.jpg') }}" alt="Per lo Shooting">
                    <div class="category-overlay">
                        <h3>Per lo Shooting</h3>
                        <p>Outfit eleganti per servizi fotografici professionali</p>
                        <a href="#products" class="btn-category">Esplora <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>

            <!-- Props Card -->
            <div class="category-card">
                <div class="category-image-wrapper">
                    <img src="{{ url_for('static', filename='immagini/shooting vecchi/props/10.jpg') }}" alt="Props & Accessories">
                    <div class="category-overlay">
                        <h3>Props & Accessori</h3>
                        <p>Completa il look con accessori unici</p>
                        <a href="#products" class="btn-category">Scopri <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>

            <!-- Occasioni Speciali Card -->
            <div class="category-card">
                <div class="category-image-wrapper">
                    <img src="{{ url_for('static', filename='immagini/shooting vecchi/originali/6.jpg') }}" alt="Occasioni Speciali">
                    <div class="category-overlay">
                        <h3>Occasioni Speciali</h3>
                        <p>Matrimoni, feste e cerimonie indimenticabili</p>
                        <a href="#products" class="btn-category">Vedi Tutto <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Products / Catalog Section -->
<section id="products" class="section products-section">
    <div class="container">
        <h2 class="section-title">La Nostra Collezione</h2>
        <p class="section-subtitle">Outfit selezionati per ogni occasione</p>

        <!-- Search and Filter Bar -->
        <div class="filter-bar">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Cerca per titolo, descrizione...">
            </div>
            <div class="filter-group">
                <select id="categoryFilter" class="filter-select">
                    <option value="">Tutte le Categorie</option>
                    <!-- Options loaded dynamically -->
                </select>
                <select id="destinationFilter" class="filter-select">
                    <option value="">Tutte le Destinazioni</option>
                    <!-- Options loaded dynamically -->
                </select>
                <select id="sizeFilter" class="filter-select">
                    <option value="">Tutte le Taglie</option>
                    <!-- Options loaded dynamically -->
                </select>
                <select id="ageRangeFilter" class="filter-select">
                    <option value="">Tutte le Età</option>
                    <!-- Options loaded dynamically -->
                </select>
                <select id="colorFilter" class="filter-select">
                    <option value="">Tutti i Colori</option>
                    <!-- Options loaded dynamically -->
                </select>
                <select id="conditionFilter" class="filter-select">
                    <option value="">Tutte le Condizioni</option>
                    <!-- Options loaded dynamically -->
                </select>
            </div>
        </div>

        <!-- Products Grid -->
        <div class="products-grid" id="productsGrid">
            <!-- Products will be loaded here via JavaScript -->
            <div class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Caricamento prodotti...</p>
            </div>
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section id="how-it-works" class="section how-it-works-section">
    <div class="container">
        <h2 class="section-title">Come funziona il noleggio</h2>
        <p class="section-subtitle">Seguire il processo di noleggio su Stycly è semplice e veloce. Ecco tutti i passaggi:</p>

        <div class="steps-grid">
            <div class="step-card">
                <div class="step-number">
                    <i class="fas fa-search"></i>
                </div>
                <h3>Cerca i prodotti</h3>
                <p>Sfoglia i Prodotti e scopri capi, accessori, props e oggetti per bambini. Filtra per categoria e guarda i dettagli di ogni articolo.</p>
            </div>

            <div class="step-card">
                <div class="step-number">
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <h3>Aggiungi al carrello</h3>
                <p>Scegli gli articoli e la quantità desiderata, poi aggiungili al carrello.</p>
            </div>

            <div class="step-card">
                <div class="step-number">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <h3>Invia una richiesta di noleggio</h3>
                <p>Nel carrello clicca su Avanti, seleziona le date di noleggio dal calendario, inserisci i tuoi dati di contatto e conferma la richiesta.</p>
            </div>

            <div class="step-card">
                <div class="step-number">
                    <i class="fas fa-envelope-open-text"></i>
                </div>
                <h3>Ricevi il preventivo</h3>
                <p>Entro 24 ore ti contattiamo via email per confermare disponibilità e inviarti il preventivo personalizzato. Completa ordine via email o telefono.</p>
            </div>

            <div class="step-card">
                <div class="step-number">
                    <i class="fas fa-credit-card"></i>
                </div>
                <h3>Pagamento e fatturazione</h3>
                <p>Pagamento concordato con il nostro operatore (non online al momento) e ricezione della fattura.</p>
            </div>
        </div>
    </div>
</section>

<!-- About Us Section -->
<section id="about" class="section about-section">
    <div class="container">
        <div class="about-content">
            <div class="about-text">
                <h2 class="section-title">Chi Siamo</h2>
                <p class="about-intro">Siamo in missione per rendere la moda per bambini sostenibile, accessibile e gioiosa.</p>

                <p>Stycly è nato da un'idea semplice: i bambini crescono velocemente, ma i vestiti belli non dovrebbero finire in discarica. Abbiamo creato una piattaforma dove genitori, fotografi e famiglie possono accedere a abbigliamento premium per bambini per ogni occasione, senza il costo ambientale della fast fashion.</p>

                <p>Il nostro modello di moda circolare significa che ogni capo ha più vite, riducendo gli sprechi e rendendo le scelte sostenibili facili e convenienti. Che tu abbia bisogno di un outfit per un servizio fotografico di famiglia, un matrimonio, una festa di compleanno, o semplicemente vuoi provare nuovi stili senza impegno, siamo qui per aiutarti.</p>

                <div class="about-values">
                    <div class="value-item">
                        <i class="fas fa-recycle"></i>
                        <h4>Economia Circolare</h4>
                        <p>Ogni noleggio riduce gli sprechi tessili e supporta il consumo sostenibile</p>
                    </div>
                    <div class="value-item">
                        <i class="fas fa-hand-holding-heart"></i>
                        <h4>Qualità Prima di Tutto</h4>
                        <p>Selezioniamo solo il meglio, assicurando che ogni pezzo soddisfi i nostri alti standard</p>
                    </div>
                    <div class="value-item">
                        <i class="fas fa-users"></i>
                        <h4>Comunità</h4>
                        <p>Costruiamo una comunità di genitori consapevoli e appassionati di stile</p>
                    </div>
                </div>
            </div>

            <div class="about-image">
                <img src="{{ url_for('static', filename='immagini/about-us.jpeg') }}" alt="Chi Siamo - Stycly" style="width: 100%; height: 100%; object-fit: cover; border-radius: 24px;">
            </div>
        </div>
    </div>
</section>

<!-- Contact Section -->
<section id="contact" class="section contact-section">
    <div class="container">
        <h2 class="section-title">Contattaci</h2>
        <p class="section-subtitle">Hai domande? Ci piacerebbe sentirti!</p>

        <div class="contact-content">
            <div class="contact-form-wrapper">
                <form method="POST" action="{{ url_for('main.contact') }}" class="contact-form">
                    <div class="form-group">
                        <label for="contact-name">Il Tuo Nome</label>
                        <input type="text" id="contact-name" name="name" required>
                    </div>

                    <div class="form-group">
                        <label for="contact-email">Indirizzo Email</label>
                        <input type="email" id="contact-email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="contact-message">Messaggio</label>
                        <textarea id="contact-message" name="message" rows="5" required></textarea>
                    </div>

                    <button type="submit" class="btn btn-accent">Invia Messaggio</button>
                </form>
            </div>

            <div class="contact-info">
                <div class="contact-info-item">
                    <i class="fas fa-envelope"></i>
                    <div>
                        <h4>Email</h4>
                        <p>info@stycly.com</p>
                    </div>
                </div>

                <div class="contact-info-item">
                    <i class="fas fa-phone"></i>
                    <div>
                        <h4>Telefono</h4>
                        <p>+39 123 456 7890</p>
                    </div>
                </div>

                <div class="contact-info-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <div>
                        <h4>Posizione</h4>
                        <p>Milano, Italia</p>
                    </div>
                </div>

                <div class="contact-info-item">
                    <i class="fas fa-clock"></i>
                    <div>
                        <h4>Orari di Apertura</h4>
                        <p>Lunedì - Venerdì: 9:00 - 18:00<br>Sabato: 10:00 - 16:00</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% if session.user_id %}
<!-- Private Wardrobe Section (Logged-in Users Only) -->
<section id="wardrobe" class="section wardrobe-section">
    <div class="container">
        <h2 class="section-title">Il Mio Guardaroba Privato</h2>
        <p class="section-subtitle">Gestisci la tua collezione</p>

        <!-- Add Item Form -->
        <div class="wardrobe-add-form">
            <button class="btn btn-accent" onclick="toggleAddItemForm()">
                <i class="fas fa-plus"></i> Aggiungi Nuovo Articolo
            </button>
            
            <form id="addItemForm" method="POST" action="{{ url_for('wardrobe.add_item') }}" enctype="multipart/form-data" class="item-form" style="display: none;">
                <div class="form-row">
                    <div class="form-group">
                        <label for="title">Titolo *</label>
                        <input type="text" id="title" name="title" required placeholder="es., Vestito Estivo Blu">
                    </div>

                    <div class="form-group">
                        <label for="destination">Destinazione *</label>
                        <select id="destination" name="destination" required>
                            <option value="">Seleziona Destinazione</option>
                            <option value="Bambino">Bambino</option>
                            <option value="Bambina">Bambina</option>
                            <option value="Stycly props">Stycly Props</option>
                            <option value="Stycly accessories">Stycly Accessories</option>
                            <option value="Stycly Vintage">Stycly Vintage</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="category">Categoria *</label>
                        <select id="category" name="category" required>
                            <option value="">Seleziona Categoria</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="size">Taglia</label>
                        <select id="size" name="size">
                            <option value="">Seleziona Taglia</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="description">Descrizione</label>
                    <textarea id="description" name="description" rows="3" placeholder="Descrivi l'articolo in dettaglio..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="color">Colore</label>
                        <select id="color" name="color">
                            <option value="">Seleziona Colore</option>
                            <option value="White">White</option>
                            <option value="Ivory">Ivory</option>
                            <option value="Cream">Cream</option>
                            <option value="Beige">Beige</option>
                            <option value="Black">Black</option>
                            <option value="Gray">Gray</option>
                            <option value="Red">Red</option>
                            <option value="Pink">Pink</option>
                            <option value="Rose">Rose</option>
                            <option value="Coral">Coral</option>
                            <option value="Orange">Orange</option>
                            <option value="Peach">Peach</option>
                            <option value="Yellow">Yellow</option>
                            <option value="Gold">Gold</option>
                            <option value="Green">Green</option>
                            <option value="Mint">Mint</option>
                            <option value="Sage">Sage</option>
                            <option value="Olive">Olive</option>
                            <option value="Blue">Blue</option>
                            <option value="Navy">Navy</option>
                            <option value="Sky Blue">Sky Blue</option>
                            <option value="Turquoise">Turquoise</option>
                            <option value="Teal">Teal</option>
                            <option value="Purple">Purple</option>
                            <option value="Lavender">Lavender</option>
                            <option value="Violet">Violet</option>
                            <option value="Brown">Brown</option>
                            <option value="Tan">Tan</option>
                            <option value="Camel">Camel</option>
                            <option value="Silver">Silver</option>
                            <option value="Metallic Gold">Metallic Gold</option>
                            <option value="Rose Gold">Rose Gold</option>
                            <option value="Multicolor">Multicolor</option>
                            <option value="Floral">Floral</option>
                            <option value="Striped">Striped</option>
                            <option value="Polka Dot">Polka Dot</option>
                            <option value="Checkered">Checkered</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="condition">Condizione *</label>
                        <select id="condition" name="condition" required>
                            <option value="">Seleziona Condizione</option>
                            <option value="New with Tags">Nuovo con Etichette</option>
                            <option value="New without Tags">Nuovo senza Etichette</option>
                            <option value="Like New">Come Nuovo</option>
                            <option value="Excellent">Eccellente</option>
                            <option value="Very Good">Molto Buono</option>
                            <option value="Good">Buono</option>
                            <option value="Fair">Discreto</option>
                            <option value="Vintage">Vintage</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="stock">Quantità Disponibile</label>
                        <input type="number" id="stock" name="stock" min="1" value="1">
                    </div>
                </div>

                <div class="form-group">
                    <label for="images">Immagini (Multiplo consentito)</label>
                    <input type="file" id="images" name="images" accept="image/*" multiple>
                    <small class="form-help">Puoi selezionare più immagini. Trascina per riordinare.</small>
                    <div id="imagePreviewContainer" class="image-preview-container"></div>
                </div>

                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" name="is_public" checked>
                        <span>Rendi pubblicamente disponibile per il noleggio</span>
                    </label>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-accent">Aggiungi Articolo</button>
                    <button type="button" class="btn btn-secondary" onclick="toggleAddItemForm()">Annulla</button>
                </div>
            </form>
        </div>
        
        <!-- Wardrobe Items Grid -->
        <div class="wardrobe-items" id="wardrobeItems">
            <!-- Items will be loaded here or shown from server -->
            <p class="no-items">Non hai ancora aggiunto articoli. Clicca su "Aggiungi Nuovo Articolo" per iniziare!</p>
        </div>
    </div>
</section>
{% endif %}

<!-- Rental Request Section (Cart Checkout) -->
<section id="rental-request" class="section rental-section" style="display: none;">
    <div class="container">
        <h2 class="section-title">Completa la Tua Richiesta di Noleggio</h2>
        <p class="section-subtitle">Solo qualche dettaglio in più e sei pronto!</p>

        <div class="rental-checkout-grid">
            <!-- Order Summary (Left Column) -->
            <div class="order-summary">
                <h3><i class="fas fa-shopping-bag"></i> Riepilogo Ordine</h3>
                <div id="order-summary-items" class="order-summary-items">
                    <!-- Will be populated by JavaScript -->
                </div>
                <div class="order-summary-dates">
                    <p><strong>Date noleggio:</strong></p>
                    <p id="summary-dates">Da selezionare</p>
                </div>
            </div>

            <!-- Rental Form (Right Column) -->
            <div class="rental-form-wrapper">
                <form method="POST" action="{{ url_for('orders.submit_order') }}" class="rental-form">
            <div class="form-section">
                <h3><i class="fas fa-calendar"></i> Periodo di Noleggio</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label for="start_date">Data Inizio *</label>
                        <input type="date" id="start_date" name="start_date" required>
                    </div>

                    <div class="form-group">
                        <label for="end_date">Data Fine *</label>
                        <input type="date" id="end_date" name="end_date" required>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3><i class="fas fa-user"></i> Le Tue Informazioni</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label for="rental_name">Nome Completo *</label>
                        <input type="text" id="rental_name" name="name" {% if session.user_name %}value="{{ session.user_name }}"{% endif %} required>
                    </div>

                    <div class="form-group">
                        <label for="rental_email">Indirizzo Email *</label>
                        <input type="email" id="rental_email" name="email" {% if session.user_email %}value="{{ session.user_email }}"{% endif %} required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="phone">Numero di Telefono</label>
                    <input type="tel" id="phone" name="phone">
                </div>

                <div class="form-group">
                    <label for="notes">Note / Richieste Speciali</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Eventuali richieste speciali o informazioni che dovremmo sapere..."></textarea>
                </div>
            </div>

            <div class="form-section">
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" name="privacy" required>
                        <span>Accetto la <a href="#" target="_blank">Privacy Policy</a> e i <a href="#" target="_blank">Termini e Condizioni</a> *</span>
                    </label>
                </div>
            </div>

            <div class="form-actions centered">
                <button type="submit" class="btn btn-primary btn-large">
                    <i class="fas fa-paper-plane"></i> Invia Richiesta di Noleggio
                </button>
            </div>
                </form>
            </div>
        </div>
    </div>
</section>

<!-- Professional Product Detail Modal -->
<div id="productDetailModal"
     class="pdm-modal"
     role="dialog"
     aria-modal="true"
     aria-labelledby="pdm-title"
     aria-hidden="true">

    <!-- Backdrop with blur -->
    <div class="pdm-backdrop" onclick="closeProductDetail()" aria-label="Chiudi modal"></div>

    <!-- Modal Container -->
    <div class="pdm-container">
        <!-- Close Button -->
        <button class="pdm-close"
                onclick="closeProductDetail()"
                aria-label="Chiudi dettagli prodotto"
                type="button">
            <i class="fas fa-times"></i>
        </button>

        <!-- Modal Content -->
        <div class="pdm-content">
            <!-- LEFT: Image Gallery Section -->
            <div class="pdm-gallery">
                <!-- Main Image with Zoom -->
                <div class="pdm-main-image-wrapper">
                    <div class="pdm-main-image" id="pdmMainImageContainer">
                        <img id="pdmMainImage"
                             src=""
                             alt="Product Image"
                             loading="lazy">
                        <!-- Zoom Indicator -->
                        <div class="pdm-zoom-hint">
                            <i class="fas fa-search-plus"></i>
                            Passa sopra per ingrandire
                        </div>
                    </div>

                    <!-- Image Counter -->
                    <div class="pdm-image-counter" id="pdmImageCounter">
                        <span id="pdmCurrentImage">1</span> / <span id="pdmTotalImages">1</span>
                    </div>
                </div>

                <!-- Thumbnails -->
                <div class="pdm-thumbnails" id="pdmThumbnails">
                    <!-- Thumbnails will be inserted dynamically -->
                </div>

                <!-- Navigation Dots (Mobile) -->
                <div class="pdm-dots" id="pdmDots">
                    <!-- Dots will be inserted dynamically -->
                </div>
            </div>

            <!-- RIGHT: Product Info Section -->
            <div class="pdm-info">
                <div class="pdm-info-scroll">
                    <!-- Header -->
                    <div class="pdm-header">
                        <h2 class="pdm-title" id="pdm-title"></h2>

                        <!-- Rating & Reviews -->
                        <div class="pdm-rating">
                            <div class="pdm-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <span class="pdm-rating-text">4.5 · 24 recensioni</span>
                        </div>

                        <!-- Badges -->
                        <div class="pdm-badges" id="pdmBadges">
                            <!-- Badges will be inserted dynamically -->
                        </div>
                    </div>

                    <!-- Stock Availability -->
                    <div class="pdm-stock" id="pdmStock">
                        <!-- Stock indicator will be inserted dynamically -->
                    </div>

                    <!-- Description -->
                    <div class="pdm-description">
                        <p id="pdmDescriptionText"></p>
                        <button class="pdm-expand-btn" id="pdmExpandBtn" onclick="toggleDescription()">
                            Vedi dettagli completi <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="pdm-description-full" id="pdmDescriptionFull">
                            <p id="pdmDescriptionFullText"></p>
                        </div>
                    </div>

                    <!-- Size Selector -->
                    <div class="pdm-selector-group">
                        <div class="pdm-selector-label">
                            <span>Taglia</span>
                            <button class="pdm-size-guide" onclick="openSizeGuide()">
                                <i class="fas fa-ruler"></i> Guida alle taglie
                            </button>
                        </div>
                        <div class="pdm-size-options" id="pdmSizeOptions">
                            <!-- Size options will be inserted dynamically -->
                        </div>
                        <div class="pdm-size-stock-hint" id="pdmSizeStockHint"></div>
                    </div>

                    <!-- Color Selector (if applicable) -->
                    <div class="pdm-selector-group" id="pdmColorGroup" style="display: none;">
                        <div class="pdm-selector-label">
                            <span>Colore</span>
                            <span class="pdm-color-name" id="pdmColorName"></span>
                        </div>
                        <div class="pdm-color-options" id="pdmColorOptions">
                            <!-- Color options will be inserted dynamically -->
                        </div>
                    </div>

                    <!-- Quantity Selector -->
                    <div class="pdm-selector-group">
                        <div class="pdm-selector-label">
                            <span>Quantità</span>
                        </div>
                        <div class="pdm-quantity">
                            <button class="pdm-qty-btn"
                                    onclick="decreaseQty()"
                                    aria-label="Diminuisci quantità"
                                    type="button">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input type="number"
                                   id="pdmQtyInput"
                                   value="1"
                                   min="1"
                                   max="10"
                                   readonly
                                   aria-label="Quantità">
                            <button class="pdm-qty-btn"
                                    onclick="increaseQty()"
                                    aria-label="Aumenta quantità"
                                    type="button">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Product Highlights -->
                    <div class="pdm-highlights">
                        <h3>Caratteristiche</h3>
                        <ul id="pdmHighlights">
                            <li><i class="fas fa-check-circle"></i> Materiale di alta qualità</li>
                            <li><i class="fas fa-check-circle"></i> Vestibilità comfort</li>
                            <li><i class="fas fa-check-circle"></i> Facile da lavare</li>
                        </ul>
                    </div>

                    <!-- Service Icons -->
                    <div class="pdm-services">
                        <div class="pdm-service-item">
                            <i class="fas fa-shipping-fast"></i>
                            <div>
                                <strong>Spedizione Veloce</strong>
                                <p>2-3 giorni lavorativi</p>
                            </div>
                        </div>
                        <div class="pdm-service-item">
                            <i class="fas fa-undo-alt"></i>
                            <div>
                                <strong>Resi Gratuiti</strong>
                                <p>Entro 30 giorni</p>
                            </div>
                        </div>
                        <div class="pdm-service-item">
                            <i class="fas fa-lock"></i>
                            <div>
                                <strong>Pagamento Sicuro</strong>
                                <p>Transazioni protette</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CTA Button (Sticky on Mobile) -->
                <div class="pdm-cta">
                    <button class="pdm-add-to-cart"
                            id="pdmAddToCartBtn"
                            onclick="addToCartFromModal()"
                            type="button">
                        <i class="fas fa-shopping-bag"></i>
                        <span id="pdmBtnText">Aggiungi al Carrello</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Toast Notification -->
<div class="pdm-toast" id="pdmToast" role="alert">
    <i class="fas fa-check-circle"></i>
    <span id="pdmToastText">Prodotto aggiunto al carrello!</span>
</div>

{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/product_modal.css') }}?v=1">
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/products.js') }}"></script>
<script src="{{ url_for('static', filename='js/product_modal.js') }}?v=1"></script>
{% if session.user_id %}
<script src="{{ url_for('static', filename='js/wardrobe.js') }}"></script>
<script src="{{ url_for('static', filename='js/wardrobe-form.js') }}"></script>
{% endif %}
{% endblock %}
